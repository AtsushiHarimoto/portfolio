# 03.2. ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

> **ç¨®é¡**: ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ & é‹ç”¨  
> **é‡ç‚¹**: `install.sh` + `install.ps1` ã‚’ä½¿ã„ã€OS é–“ã®ç’°å¢ƒå·®ã‚’ä¸€ç™ºã§å¸åã™ã‚‹å …ç‰¢ã‹ã¤è¦ªåˆ‡ãªè‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ›¸ãæ–¹ã‚’ç¤ºã—ã¾ã™ã€‚

---

## æ¦‚è¦

OSS ã‚„ç¤¾å†…ãƒ„ãƒ¼ãƒ«ã¯ã€macOS/Linux/Windows ã®ãƒãƒ©ãƒãƒ©ãªç’°å¢ƒã«ã‚³ã‚±ãŒã¡ã§ã™ã€‚ä¾å­˜ã®æ‰‹å‹•ãƒ“ãƒ«ãƒ‰ã‚„ãƒ„ãƒ¼ãƒ«æ¬ æã«ã‚ˆã‚Šã€æ–°äººãŒç’°å¢ƒæ§‹ç¯‰ã§æŒ«æŠ˜ã™ã‚‹ã“ã¨ã‚‚ã€‚OS ã‚’å•ã‚ãªã„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”¨æ„ã™ã‚Œã°ã€æ•°æ™‚é–“ã®èª¿æŸ»ãŒä¸€ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§å®Œäº†ã—ã€Rust ã‚„ Python ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã€Œãƒãƒ¼ãƒ©ãƒƒã‚¯ã€ä½“é¨“ã‚’æä¾›ã§ãã¾ã™ã€‚

---

## è¨­è¨ˆã®æŸ±

1. **å†ªç­‰æ€§ãƒã‚§ãƒƒã‚¯**ï¼šPATH ã‚„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’äº‹å‰ã«ç¢ºèªã—ã€æ—¢å­˜ãƒ„ãƒ¼ãƒ«ãŒã‚ã‚Œã°ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚å†å®Ÿè¡Œã§ç’°å¢ƒãŒæ±šæŸ“ã•ã‚Œãªã„ã“ã¨ãŒåŸºæœ¬ã§ã™ã€‚  
2. **é˜²å¾¡çš„å®Ÿè£…**ï¼šãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«å¤±æ•—ã—ãŸã‚‰å³åº§ã«å¤±æ•—ï¼ˆFail-Fastï¼‰ã€‚å£Šã‚ŒãŸã¾ã¾æ¬¡ã®æ‰‹é †ã«é€²ã¾ã›ãªã„ã€‚  
3. **è¦–èªæ€§ã®é«˜ã„å‡ºåŠ›**ï¼šBash ã§ã¯ ANSI ã‚«ãƒ©ãƒ¼ã€PowerShell ã§ã¯æ–‡å­—è‰²ã§ã€Œæƒ…å ±ï¼ˆé’ï¼‰ã€ã€Œè­¦å‘Šï¼ˆé»„ï¼‰ã€ã€Œè‡´å‘½ï¼ˆèµ¤ï¼‰ã€ã‚’åŒºåˆ¥ã—ã¾ã™ã€‚  
4. **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³**ï¼šé«˜æ¨©é™æ“ä½œã‚„æ•° GB ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«ã¯æ˜ç¤ºçš„ãªç¢ºèªã‚’è¿½åŠ ã—ã€é—‡é‹çš„ãªå¤‰æ›´ã‚’é˜²ãã¾ã™ã€‚

---

## ç¬¬1ç« ï¼šmacOS / Linux (`install.sh`)

```bash
#!/bin/bash
set -e

GREEN='\033[0;32m'; YELLOW='\033[1;33m'; NC='\033[0m'

command_exists() { command -v "$1" >/dev/null 2>&1; }

print_success() { echo -e "${GREEN}âœ… $1${NC}"; }
print_warning() { echo -e "${YELLOW}âš ï¸  $1${NC}"; }

check_rust_toolchain() {
  echo ">> Rust ãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã‚’æ¤œè¨¼ä¸­..."
  if command_exists rustc && command_exists cargo; then
    RUST_VERSION=$(rustc --version | awk '{print $2}')
    print_success "Rust ãŒæ—¢ã«å°å…¥ã•ã‚Œã¦ã„ã¾ã™ï¼š$RUST_VERSION"
    return 0
  else
    print_warning "rustc/cargo ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"
    return 1
  fi
}

install_rust_interactive() {
  read -p "Rust ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã‹ï¼Ÿ(y/n): " -n 1 -r
  echo ""
  if [[ $REPLY =~ ^[Yy]$ ]]; then
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    source "$HOME/.cargo/env"
    print_success "Rust ã®å°å…¥ãŒå®Œäº†ã—ã¾ã—ãŸã€‚"
  fi
}

main() {
  if ! check_rust_toolchain; then
    install_rust_interactive
  fi
  cargo build --release
}

main
```

---

## ç¬¬2ç« ï¼šWindows (`install.ps1`)

```powershell
$ErrorActionPreference = "Stop"

function Write-Success { param([string]$Message) Write-Host "âœ… $Message" -ForegroundColor Green }
function Write-Info { param([string]$Message) Write-Host ">> $Message" -ForegroundColor Cyan }

function Test-CommandExists {
  param([string]$Command)
  try { Get-Command $Command -ErrorAction Stop; return $true } catch { return $false }
}

function Test-And-Install-Rust {
  Write-Info "Rust ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’æ¤œæŸ»..."
  if (Test-CommandExists "rustc" -and Test-CommandExists "cargo") {
    $version = (rustc --version).Split(' ')[1]
    Write-Success "Rust æº–å‚™å®Œäº†ï¼ˆ$versionï¼‰"
  } else {
    Write-Host "âš ï¸ Rust ãŒæœªå°å…¥ã§ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é–‹å§‹ã—ã¾ã™..." -ForegroundColor Yellow
    $url = "https://win.rustup.rs/x86_64"
    $path = "$env:TEMP\rustup-init.exe"
    Invoke-WebRequest -Uri $url -OutFile $path
    Start-Process -FilePath $path -Wait -NoNewWindow
    $env:Path = [System.Environment]::GetEnvironmentVariable("Path", "Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path", "User")
  }
}

try {
  Test-And-Install-Rust
  cargo build --release
} catch {
  Write-Host "ğŸš§ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼ï¼š$_" -ForegroundColor Red
  exit 1
}
```

---

## ç¬¬3ç« ï¼šã‚ˆãã‚ã‚‹è½ã¨ã—ç©´

1. **ç’°å¢ƒå¤‰æ•°ã®åæ˜ å¿˜ã‚Œ**ï¼šæ–°è¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã« `source ~/.cargo/env` ã‚„ `$env:Path` ã®æ›´æ–°ã‚’å¿˜ã‚Œã‚‹ã¨ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ãŒã€Œã‚³ãƒãƒ³ãƒ‰ãªã—ã€ã¨ãªã‚‹ã€‚  
2. **å®Ÿè¡Œãƒãƒªã‚·ãƒ¼**ï¼šWindows ã¯ç½²åãªã—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ‹’å¦ã™ã‚‹ã€‚å°å…¥æ‰‹é †ã« `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser` ã‚’ç››ã‚Šè¾¼ã‚€ã€‚  
3. **ãƒãƒ³ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–é‹è»¢**ï¼šCIï¼ˆGitHub Actions ãªã©ï¼‰ã§å¯¾è©±ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ãƒãƒ³ã‚°ã™ã‚‹ãŸã‚ã€`--unattended` ã‚„ `-y` ãƒ•ãƒ©ã‚°ã‚’ç”¨æ„ã—ã€æ‰‹ã‚’å‹•ã‹ã•ãšå®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
