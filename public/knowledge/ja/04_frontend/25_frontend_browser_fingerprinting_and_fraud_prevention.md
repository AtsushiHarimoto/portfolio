# 25. ブラウザ指紋と無感作動の詐欺防止 (Browser Fingerprinting & Fraud Prevention)

> **種類**: ダーク UX とアンチフラウド  
> **重点**: 悪意あるスクリプトが Chrome を偽って API を叩くとき、ブラウザ指紋・reCAPTCHA v3・デバイス証明で追跡し、正規ユーザーだけを通す。

---

## 序章：Cookie は消えても指紋は残る

Cookie や LocalStorage は簡単にリセットされる。ボットがそれを繰り返して多数のアカウントを作成しても、アクセスした瞬間に取得されたブラウザ／ハードウェア指紋は変わりません。

---

## 1. 指紋の構成

Canvas や AudioContext、`navigator.hardwareConcurrency`、画面解像度などを組み合わせると、驚異的な精度で個体識別できます。

### Canvas 指紋

知らないうちに怪しいグラデーションと特殊フォントを offscreen で描画し、ピクセル差をハッシュ化すれば、GPU・ドライバ・フォントレンダリングの違いが固有の識別子になります。

### Audio/WebGL 指紋

高周波音を生成し、オーディオチップの応答を観察する。これに WebGL 情報やスクリーンの寸法を加えると、広告企業が利用する強力なトラッキングが完成します。

---

## 2. Bot を封じる仕組み

毎秒 10 万件の Credential Stuffing を IP ブロックだけで防ぐことはできません。

### 旧式 CAPTCHA

「信号がある画像を選べ」などは人間にとっても苦痛で、現在の AI モデルに簡単に突破されます。死にました。

### Invisible Defense

reCAPTCHA v3 や Cloudflare Turnstile は UI にチェックボックスも出さず判定します。

1. **マウス軌跡の数理**：本物はジグザグ。Selenium は直線的で人工的。  
2. **指紋のクロスチェック**：このデバイスが YouTube を使っていた直前の行動と一致するか？  
3. **Proof-of-Work**：Web Worker で CPU 負荷の高い計算を課し、ボットの大規模同時接続を潰す。

こうして生成される「信頼度トークン」だけを登録 API が受け入れます。スコアが 0.7 未満なら 403 で拒否。

---

## 💡 Vibecoding 指示例

高リスクな会員登録を AI に任せる際は：

> 「SMS だけに頼らないで。Cloudflare Turnstile や reCAPTCHA v3 を無感で埋め込み、指紋・操作スコアをバックグラウンド送信させる。バックエンドは Google API でそのトークンを検証し、0.7 未満なら 403 を返す仕組みにしてください。」
