# ワークフロー (Workflow) ファイルフォーマット規範

> **種類**: ベストプラクティス
> **日付**: 2026-01-03
> **出典**: 会話 ID（2026-01-03 セッション）

---

## 概要

`.agent/workflows/` ワークフローファイルの標準フォーマットを定義します。YAML フロントマター (Frontmatter)、ステップ番号、turbo マーカー、エラーハンドリングテーブル、使用例を含み、ワークフローの実行可能性とメンテナンス性を確保します。

---

## 背景

ワークフローファイルは標準化されたフォーマットが必要です：

1. **AI が認識・実行可能**
2. **ステップが明確で追跡可能**
3. **エラーハンドリングが包括的**
4. **ユーザーが容易に理解可能**

---

## 詳細設計

### コアフォーマット要件

#### 1. YAML Frontmatter（必須）

各ワークフローファイルは YAML フロントマターで開始必須：

```yaml
---
description: { ワークフローの簡潔な説明 }
---
```

#### 2. タイトルと目的（必須）

```markdown
# {ワークフロー名}

## 目的
{ワークフローの目的を 1-3 段落で詳細に説明}
```

#### 3. SCOPE パスマッピング（マルチプロジェクトの場合）

#### 4. 実行ステップ（必須）

`### Step N:` フォーマットを使用：

```markdown
### Step 0: 現在の SCOPE を確認
// turbo
{ステップ説明}
**前提条件**: {あれば}
**チェック項目**:
- チェック項目 1
- チェック項目 2
**問題発見時**:
- `ASK:` でユーザーに確認
**出力**: {ステップ出力}
```

#### 5. Turbo マーカー（オプション）

ステップが自動実行可能な場合、`// turbo` マーカーを追加。

#### 6. 停止条件（必須）

#### 7. エラーハンドリングテーブル（必須）

```markdown
## エラーハンドリング

| エラー状況         | 処理方法                          |
| ------------------ | --------------------------------- |
| SCOPE 未指定       | ASK でユーザーにサブプロジェクト確認 |
| ドキュメントとコードの矛盾 | レビューレポート出力し修正戦略を ASK |
| Code Review 失敗   | issues を出力し修正待ち            |
| クロス SCOPE 変更  | 拒否し個別コミットを促す           |
```

#### 8. 使用例（推奨）

#### 9. 注意事項（推奨）

---

## 注意事項

- **YAML フロントマターはファイル最先頭に配置必須** — `---` 前に空行やコメント不可。
- **ステップ番号は Step 0 から** — Step 0 は通常 SCOPE 確認や前提チェックに使用。
- **Turbo マーカーは個別ステップにのみ適用** — ワークフロー全体が自動実行可能な場合は `// turbo-all`。
- **エラーハンドリングテーブルは一般的なエラーをカバー必須** — 最低 4-6 種類のエラーシナリオを含む。
- **使用例は実行可能であること必須** — 実際のコマンドと期待される出力を提供。

---

_本ドキュメントは `/run-wiki conversation` により自動生成されました_
