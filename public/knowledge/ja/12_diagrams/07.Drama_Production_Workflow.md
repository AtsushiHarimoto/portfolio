# 07. ドラマ制作ワークフロー（Drama Production Workflow）

## 漫劇制作の全体フローチャート

本フローチャートは、「小説テキスト」から「最終映像成果物」までのエンドツーエンド自動化パイプライン（Pipeline）を示しています。

```mermaid
graph TD
    A[小説テキスト / 脚本] -->|LLM| B(Director Agent: 脚本分解)
    B --> C{StoryPack 生成}

    subgraph "Drama Workshop（ビジュアルエディタ）"
        C --> D[DramaTimeline: タイムライン同期]
        C --> E[DramaGraph: ロジックと条件分岐]
        D & E --> F[ビジュアル調整と修正]
    end

    F --> G[MCP Server: タスクスケジューリング]

    subgraph "Asset Factory（バックエンドサービス）"
        G --> H[TTS Service: 音声生成]
        G --> I[ComfyUI: 画像/動画レンダリング]
        I --> J[Wan 2.2 / SVI ノード]
    end

    H & J --> K(Filming Studio: 動画合成)
    K --> L[最終 MP4/WebM 出力]

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style L fill:#00ff00,stroke:#333,stroke-width:4px
    style B fill:#bbf,stroke:#333
    style G fill:#f96,stroke:#333
```

## 主要技術ポイント

1.  **Director Agent**: 自然言語を `StoryPack` JSON に変換する役割を担います。
2.  **Drama Workshop**:
    - `DramaTimeline`: 効果音、音声、カメラの精密な同期を処理します。
    - `DramaGraphEditor`: VueFlow ベースで、非線形脚本構造の編集を可能にします。
3.  **タスクキュー（Task Queue）**:
    - **default queue**: TTS とデータ変換を処理（CPU 集約型）。
    - **gpu_queue**: ComfyUI レンダリングと動画合成専用（VRAM 集約型）。
