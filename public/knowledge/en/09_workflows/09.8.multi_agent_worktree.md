# Multi-Agent Isolated Development Methodology (Parallel Universe)

> Type: Best Practices
> Date: 2026-01-19

## Background

In multi-Agent (Antigravity/Codex/Claude) collaboration scenarios, when all Agents operate in the same physical directory, the following problems easily arise:

- File lock conflicts.
- `git index` state corruption (Staging area conflicts).
- Temporary files overwriting each other.
- Dev server port conflicts or dependency pollution.

## Conclusion

Adopt a "Parallel Universe" model based on `git worktree` to achieve **instant environment isolation**, giving each Agent its own independent physical workspace while sharing the Git object store.

### Core Mechanism

1. **Main Universe (Main)**: Kept clean; used only for merging final code.
2. **Parallel Universe (Worktree)**: Each task (`/iso start task-name`) creates an independent directory at `.worktrees/<task-name>`.
3. **Environment Cloning**: Automatically copies `.env` from the root directory to the isolation zone, ensuring consistent configuration.
4. **Convergence Mechanism**: Upon task completion (`/iso finish`), automatically merges back to Main and destroys the parallel universe.

## Operations Guide

### 1. Antigravity (Has `/iso` Command)

Has the highest privileges and most convenient operations:

- **Start task**: `/iso start <task-name>` (auto-creates branch `agent/<task-name>`)
- **Finish task**: `/iso finish <task-name>` (auto Merge + Remove)
- **Abort task**: `/iso drop <task-name>` (force delete)

### 2. Codex / Claude (Using Skills)

Invoke the `git-worktree-manager` Skill via natural language:

- **Start**: "Use git-worktree-manager to create a worktree for task 'api-fix'."
- **Finish**: "Finish task 'api-fix', merge and cleanup."

## Action Items

- [ ] **Permission Configuration**: Ensure `.agent/skills`, `.codex/skills`, `.claude/skills` all have `git-worktree-manager`.
- [ ] **Ignore Configuration**: `.gitignore` must include `.worktrees/`.
- [ ] **Conflict Handling**: If `/iso finish` encounters a Merge Conflict, the process pauses. Manual resolution in the main directory is required before re-executing Finish.

## References

- Skill: `git-worktree-manager`
- Workflow: `/iso`
- Config: `workspace/knowledge/11.claude_code/11.3.skills_example.md`
