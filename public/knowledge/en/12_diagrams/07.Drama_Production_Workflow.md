# 07. Drama Production Workflow

## End-to-End Drama Production Flowchart

This flowchart illustrates the end-to-end automated pipeline from novel text to final video output.

```mermaid
graph TD
    A[Novel Text / Script] -->|LLM| B(Director Agent: Script Decomposition)
    B --> C{StoryPack Generation}

    subgraph "Drama Workshop (Visual Editor)"
        C --> D[DramaTimeline: Timeline Sync]
        C --> E[DramaGraph: Logic & Conditional Branching]
        D & E --> F[Visual Adjustment & Correction]
    end

    F --> G[MCP Server: Task Scheduling]

    subgraph "Asset Factory (Backend Services)"
        G --> H[TTS Service: Voice Generation]
        G --> I[ComfyUI: Image/Video Rendering]
        I --> J[Wan 2.2 / SVI Nodes]
    end

    H & J --> K(Filming Studio: Video Compositing)
    K --> L[Final MP4/WebM Output]

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style L fill:#00ff00,stroke:#333,stroke-width:4px
    style B fill:#bbf,stroke:#333
    style G fill:#f96,stroke:#333
```

## Key Technical Points

1.  **Director Agent**: Responsible for converting natural language into `StoryPack` JSON.
2.  **Drama Workshop**:
    - `DramaTimeline`: Handles precise synchronization of sound effects, voice, and camera.
    - `DramaGraphEditor`: Built on VueFlow, enables editing of non-linear script structures.
3.  **Task Queue**:
    - **default queue**: Handles TTS and data conversion (CPU-intensive).
    - **gpu_queue**: Dedicated to ComfyUI rendering and video compositing (VRAM-intensive).
