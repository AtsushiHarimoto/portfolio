# Claude Reflect: Automated Rule Distillation System

> Type: Best Practice
> Date: 2026-01-19

## Background

- AI Agents are like rookie officers fresh out of the academy -- they tend to repeat the same mistakes, and even after you correct them, they slip right back into old habits.
- "Relying on verbal warnings to make the model remember" is extremely unreliable. We need written, enforceable rules that the repository remembers.
- `claude-reflect` is a powerful tool that turns your corrections into enforceable, version-controlled rule documents -- think of it as an automated ESLint for your AI's behavior.

---

## Key Takeaways

- **Core idea**: Transform ad-hoc corrections into enforceable ESLint-like rules, written directly into CLAUDE.md / AGENTS.md / Skills.
- **Analogy**: Think of it as an internal affairs division that collects complaints about officer conduct, then automatically compiles them into enforceable standing orders overnight -- orders the entire team must follow the next day.
- **Installation**: A Claude Code Marketplace plugin, not a pip or npm package.
- **How it works**: Capture (log the complaint) -> Queue (collect cases) -> Distill (summarize into rules) -> Human Review (final sign-off) -> Write -> Git version control.
- **Use cases**: Naming conventions, directory structure, framework-specific coding preferences, common pitfalls, fixed release processes.
- **Distillation principle**: Only distill rules that are high-frequency, stable, and verifiable.
- **Recommended cadence**: Spend 30 seconds running `/reflect` before clocking out each day; spend 5 minutes on a weekly review.

---

## Installation

```bash
# 1. Add the marketplace source
/plugin marketplace add bayramannakov/claude-reflect

# 2. Install the plugin module (like npm install)
/plugin install claude-reflect@claude-reflect-marketplace

# 3. Restart Claude Code to activate the service
```

---

## Command Reference

### Daily Distillation (End-of-Day Wrap-Up)

| Command | Purpose | Analogy |
| -------------------- | -------------------------------- | -------------------------------------------- |
| `/reflect --review`  | View pending learning signals    | Check how many complaints came in today      |
| `/reflect --dry-run` | Preview changes without writing  | Dry run (review the draft, don't publish)    |
| `/reflect`           | Process and write rules          | Officially sign off and publish the rules    |

### Historical Scan

| Command | Purpose |
| -------------------------------- | ------------------------------------ |
| `/reflect --scan-history`        | Scan past sessions to backfill rules |
| `/reflect --include-tool-errors` | Include tool errors as learning data |

### Rule Maintenance

| Command | Purpose |
| -------------------- | ------------------------------------------- |
| `/reflect --targets` | View target files                           |
| `/reflect --dedupe`  | Semantic deduplication; merge similar rules  |

### Skill Discovery & Improvement

| Command | Purpose |
| -------------------------------- | -------------------------------- |
| `/reflect-skills`                | Discover patterns from past 14 days |
| `/reflect-skills --days 30`      | Specify time range               |
| `/reflect-skills --all-projects` | Analyze all projects             |
| `/reflect-skills --dry-run`      | Preview without writing          |

### Utility Commands

| Command | Purpose |
| --------------- | ----------------------- |
| `/skip-reflect` | Skip current learning signal |
| `/view-queue`   | View pending queue      |

---

## How It Works (Automated ESLint Rule Generator)

```
User corrects Agent's code -> Background auto-collects the "complaint" into a queue -> Run /reflect before end of day
     |
AI internal affairs begins distilling into explicit rules (Always/Never/Prefer/Checklist/Gotchas)
     |
Human review and approval -> Officially written to CLAUDE.md / AGENTS.md / Skill files
     |
Git commit with version control -> All new Agents read and comply going forward
```

### Rule Write Targets

| Rule Type | Write Location |
| ---------- | ------------------------- |
| Global rules | `CLAUDE.md` / `AGENTS.md` |
| Skill improvements | `.claude/commands/*.md` |

### Skill Improvement Routing (Precision Targeting)

When you correct the agent while using a specific skill, the complaint is automatically routed back to that skill file:

```
/deploy -> Claude forgets to run tests first -> Supervisor corrects -> /reflect detects it relates to /deploy
-> Automatically updates .claude/commands/deploy.md with a new rule: "Must run unit tests before execution"
```

---

## Best Practices

### End of Day (30-Second Wrap-Up)

```bash
/reflect --review
/reflect --dry-run
/reflect
```

### Weekly Review (5-Minute Cleanup)

```bash
/reflect --scan-history
/reflect --dedupe
/reflect-skills --days 7
```

### What Is Worth Distilling Into Rules?

**Worth distilling**:

- Mistakes corrected more than twice (recurring pitfalls).
- Issues that repeatedly waste debugging time.
- Things expressible as a single, strong, enforceable rule (e.g., "Never use `var`").

**Not worth distilling**:

- One-off edge-case bugs.
- Temporary approaches that might be reversed next week.
- Highly subjective rules that cannot be verified programmatically.

---

## Moyin Project Integration Status

| Component | Location | Description |
| ----------- | ----------------------------------------------------------------------- | --------------------------------------- |
| Workflow    | `.agent/workflows/reflect.md`                                           | Antigravity-specific `/reflect` batch workflow |
| Codex Skill | `.codex/skills/reflect/SKILL.md`                                        | Codex-specific reflect skill            |
| Config Doc  | `workspace/knowledge/11.claude_code/11.4.11.4.skills_plugins_config.md` | Plugin configuration inventory          |
| Usage Example | `workspace/knowledge/11.claude_code/11.3.11.3.skills_example.md`      | Command quick reference                 |

---

## Action Checklist

- [ ] Run `/reflect --review` before end of day to review complaints, then `/reflect` to close them out.
- [ ] Run `/reflect --dedupe` once a week to clean up expired or duplicate rules.
- [ ] Run `/reflect-skills --days 30` once a month to discover patterns worth modularizing into new skills.
- [ ] Include CLAUDE.md changes in Git commits to share institutional knowledge with the team.

---

## References

- [GitHub: BayramAnnakov/claude-reflect](https://github.com/BayramAnnakov/claude-reflect)
- [Anthropic: Claude Code Official Docs](https://claude.ai/code)
- [DevelopersDigest Methodology](https://www.developersdigest.tech/)
